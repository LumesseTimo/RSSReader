@{
    ViewBag.Title = "Home Page";
}

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="~/Scripts/js.cookie.js"></script>
<script src="~/JavaScript.js"></script>
<script>
    function UnSubscribe(id) {
        if ($('#icon' + id).attr('add') !== undefined && $('icon' + id).attr('add') !== false) {
            $('#icon' + id).removeAttr('add');
            $('#icon' + id).attr('remove', true);
        }
        else {
            $('#icon' + id).removeAttr('remove');
            $('#icon' + id).attr('add',true);
        }
    }

    function getItems() {

        $.ajax({
            type: "GET",
            url: "Home/RSS_Feedlist",
            success: function (data) {
                $("#feed").html(data);
            }
        });

    }

    function getFeeds() {

        $.ajax({
            type: "GET",
            url: "Home/RSS_Sourcelist",
            success: function (data) {
                $("#sources").html(data + "<div class='RSS-Source Row addFeed'>"
                                    + "<div class='RSS-Link col-xs-12 alignContainer'>"
                                    + "<span class='alignHelper'></span>"
                                    + "<span class='aligner'>"
                                    + "<span class='glyphicon glyphicon-remove-circle' add></span>"
                                    + "Add Other RSS-Feed"
                                    + "</span>"
                                    + "</div>"
                                    + "</div>"
                                    );
            }
        });

    }

    $(document).ready(function () {
        getItems();
        getFeeds();   
});

    function addFeed(link) {
        var NewChannel = { "link": link, "categories": null };
        for (var i = 0; i <= document.getElementsByName('Category').length; i++) {
            NewChannel.categories[NewChannel.categories.length - 1] = document.getElementsByName('Category')[i].value;
        }
        var Channels = Cookies.getJSON('Sources');
        Channels.channel[Channels.channel.length] = JSON.stringify(NewChannel);
        Cookies.set('Sources', JSON.stringify(Channels));

        var getChannels = Cookies.getJSON('Sources'); //gets the JSON-Objekt, which is saved in the Cookie "Sources"
        for (var i = 0; i < getChannels.channel.length; i++) { //runs through all the channels saved in that Cookie

            var getChannel = JSON.parse(getChannels.channel[i]); //creates a JSON-object for the current channel
            for (var j = 0; j < getChannel.categories.length; j++) { //runs through all the saved categories for that channel
                /* INSERT STUFF YOU WANT TO DO WITH THE CATEGORIES */
            }
        }
    }

    function removeFeed(link) {

        var getChannels = Cookies.getJSON('Sources'); //gets the JSON-Objekt, which is saved in the Cookie "Sources"
        for (var i = 0; i < getChannels.channel.length; i++) { //runs through all the channels saved in that Cookie

            var getChannel = JSON.parse(getChannels.channel[i]); //creates a JSON-object for the current channel
            if (getChannel.link == link) {
                delete getChannels.channel[i];
                break;
            }
        }
    }




</script>

<div class="feed col-xs-8" id="feed">

</div>
<div class="sources col-xs-4" id="sources">
    
</div>
<div id="cookie">

</div>
